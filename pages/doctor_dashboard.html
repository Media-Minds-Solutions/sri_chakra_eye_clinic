<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Doctor Dashboard - Sri Chakra Eye Clinic | Practice Management System</title>
    <meta name="description" content="Secure doctor dashboard for Sri Chakra Eye Clinic. Manage appointments, patient records, prescriptions, and practice analytics with HIPAA-compliant interface." />
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fsrichakra6267back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.8"></script>
</head>
<body class="bg-surface">
    <!-- Login Modal (Initially Visible) -->
    <div id="loginModal" class="fixed inset-0 bg-primary bg-opacity-90 flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-large">
            <div class="text-center mb-8">
                <div class="flex items-center justify-center mb-4">
                    <img src="images/Sri_Chakra_Logo.png" alt="Sri Chakra Logo" class="h-15 w-20 object-contain">
                </div>
                <h2 class="font-headline font-bold text-2xl text-primary mb-2">Doctor Portal</h2>
                <p class="font-body text-text-secondary">Secure access to Sri Chakra Eye Clinic</p>
            </div>

            <form id="loginForm" class="space-y-6" onsubmit="handleLogin(event)">
                <div>
                    <label class="block text-sm font-semibold text-text-primary mb-2">Username</label>
                    <input type="text" id="username" class="input-field" placeholder="Enter your username" required />
                </div>
                
                <div>
                    <label class="block text-sm font-semibold text-text-primary mb-2">Password</label>
                    <input type="password" id="password" class="input-field" placeholder="Enter your password" required />
                </div>

                <div class="flex items-center justify-between">
                    <label class="flex items-center">
                        <input type="checkbox" class="rounded border-gray-300 text-primary focus:ring-primary" />
                        <span class="ml-2 text-sm text-text-secondary">Remember me</span>
                    </label>
                    <a href="javascript:void(0)" class="text-sm text-secondary hover:text-secondary-700">Forgot password?</a>
                </div>

                <button type="submit" class="btn-primary w-full text-lg py-4">
                    Secure Login
                </button>

                <div class="text-center text-xs text-text-secondary mt-4">
                    <p>Demo Credentials:</p>
                    <p>Username: <strong>dr.priya</strong> | Password: <strong>secure123</strong></p>
                    <p>Admin: <strong>admin</strong> | Password: <strong>admin2025</strong></p>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Dashboard (Initially Hidden) -->
    <div id="dashboardContent" class="hidden">
        <!-- Header -->
        <header class="bg-white shadow-soft sticky top-0 z-40">
            <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <!-- Logo -->
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <img src="images/Sri_Chakra_Logo.png" alt="Sri Chakra Logo" class="h-15 w-20 object-contain">
                        </div>
                        <div class="ml-3">
                            <h1 class="font-headline font-bold text-xl text-primary">Sri Chakra</h1>
                            <p class="text-sm text-text-secondary font-body">Doctor Portal</p>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="hidden md:block">
                        <div class="ml-10 flex items-baseline space-x-8">
                            <a href="homepage.html" class="text-text-secondary hover:text-primary px-3 py-2 text-sm font-body transition-colors">Public Site</a>
                            <a href="services_overview.html" class="text-text-secondary hover:text-primary px-3 py-2 text-sm font-body transition-colors">Services</a>
                            <a href="contact_location.html" class="text-text-secondary hover:text-primary px-3 py-2 text-sm font-body transition-colors">Contact</a>
                        </div>
                    </div>

                    <!-- User Profile & Actions -->
                    <div class="flex items-center space-x-4">
                        <div class="hidden lg:block text-right">
                            <p class="text-sm font-semibold text-primary" id="doctorName">Dr. Priya Sharma</p>
                            <p class="text-xs text-text-secondary">Ophthalmologist</p>
                        </div>
                        <div class="relative">
                            <button class="flex items-center space-x-2 text-text-secondary hover:text-primary" onclick="toggleUserMenu()">
                                <img src="https://images.unsplash.com/photo-1559839734-2b71ea197ec2?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3" alt="Doctor Profile" class="w-8 h-8 rounded-full object-cover" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                </svg>
                            </button>
                            <div id="userMenu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-medium py-2">
                                <a href="javascript:void(0)" class="block px-4 py-2 text-sm text-text-secondary hover:bg-surface">Profile Settings</a>
                                <a href="javascript:void(0)" class="block px-4 py-2 text-sm text-text-secondary hover:bg-surface">Change Password</a>
                                <hr class="my-2" />
                                <a href="javascript:void(0)" onclick="logout()" class="block px-4 py-2 text-sm text-error hover:bg-surface">Logout</a>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </header>

        <!-- Dashboard Content -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Welcome Section -->
            <div class="mb-8">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div>
                        <h1 class="font-headline font-bold text-3xl text-primary mb-2">
                            Good Morning, <span id="welcomeName">Dr. Priya</span>
                        </h1>
                        <p class="font-body text-text-secondary">
                            Today is <span id="currentDate">Friday, August 30, 2025</span> • 
                            <span class="text-secondary font-semibold">8 appointments scheduled</span>
                        </p>
                    </div>
                    <div class="mt-4 md:mt-0 flex space-x-3">
                        <button onclick="showEmergencySlot()" class="btn-accent px-4 py-2 text-sm">
                            Emergency Slot
                        </button>
                        <button onclick="generateReport()" class="btn-secondary px-4 py-2 text-sm">
                            Generate Report
                        </button>
                    </div>
                </div>
            </div>
            <iframe src="https://calendar.google.com/calendar/embed?src=thummalaseshadri%40gmail.com&ctz=Asia%2FKolkata" style="border: 0" width="800" height="600" frameborder="0" scrolling="no"></iframe>

           <title>Doctor Dashboard</title>
            <style>
                body { font-family: Arial, sans-serif; margin: 20px; }
                table { border-collapse: collapse; width: 100%; margin-top: 20px; }
                th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                th { background: #f4f4f4; }
                input[type="date"] { padding: 5px; }
            </style>
            <h2>Appointments Dashboard</h2>
            <label for="dateSelector">Select Date:</label>
            <input type="date" id="dateSelector">

            <table id="appointmentsTable">
                <thead>
                <tr>
                    <th>Time</th>
                    <th>Patient</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>Location</th>
                    <th>Status</th>
                </tr>
                </thead>
                <tbody></tbody>
            </table>
            <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbwUBMrJDyLHu49XIYBHOGkeBiF9tUnkT7kC833LG8kH7rq5lt_EPIX-o8YTU5lMCfA/exec"; // e.g. https://script.google.com/macros/s/XXXX/exec

    // format to YYYY-MM-DD (for <input type="date">)
    function todayISO() {
      const d = new Date();
      return d.toISOString().split('T')[0];
    }

    document.getElementById("dateSelector").value = todayISO();

    // This function is called by Apps Script JSONP response
    function loadAppointments(data) {
      const dateSel = document.getElementById("dateSelector").value;
      const [yyyy, mm, dd] = dateSel.split("-");
      const filterDate = `${dd}/${mm}/${yyyy}`; // matches sheet format dd/MM/yyyy

      const tbody = document.querySelector("#appointmentsTable tbody");
      tbody.innerHTML = "";

      const filtered = data.filter(app => app.Date === filterDate);

      if (filtered.length === 0) {
        tbody.innerHTML = `<tr><td colspan="6">No appointments</td></tr>`;
        return;
      }

      filtered.forEach(app => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${app["Start Time"]} - ${app["End Time"]}</td>
          <td>${app["Patient Name"]}</td>
          <td>${app["Email"]}</td>
          <td>${app["Phone Number"]}</td>
          <td>${app["Location/Notes"]}</td>
          <td>${app["Status"]}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function fetchAppointments() {
      // Remove old JSONP script if exists
      const oldScript = document.getElementById("jsonpScript");
      if (oldScript) oldScript.remove();

      // Append new script tag
      const script = document.createElement("script");
      script.id = "jsonpScript";
      script.src = API_URL + "?callback=loadAppointments";
      document.body.appendChild(script);
    }

    document.getElementById("dateSelector").addEventListener("change", fetchAppointments);

    // Initial load
    fetchAppointments();
</script>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-primary text-white py-8 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                <div class="flex items-center mb-4 md:mb-0">
                    <img src="images/Sri_Chakra_Logo.png" alt="Sri Chakra Logo" class="h-15 w-20 object-contain">
                    <div>
                        <h3 class="font-headline font-bold text-lg">Sri Chakra Eye Clinic</h3>
                        <p class="text-sm text-blue-200">Doctor Portal - Secure & HIPAA Compliant</p>
                    </div>
                </div>
                
                <div class="flex space-x-6">
                    <a href="homepage.html" class="text-blue-200 hover:text-white transition-colors">Public Site</a>
                    <a href="about_sri_chakra_eye_clinic.html" class="text-blue-200 hover:text-white transition-colors">About</a>
                    <a href="contact_location.html" class="text-blue-200 hover:text-white transition-colors">Contact</a>
                    <a href="javascript:void(0)" class="text-blue-200 hover:text-white transition-colors">Privacy Policy</a>
                </div>
            </div>
            
            <div class="border-t border-blue-700 mt-6 pt-6 text-center">
                <p class="font-body text-blue-200 text-sm">
                    © 2025 Sri Chakra Eye Clinic. All Rights Reserved. | Secure Medical Portal
                </p>
            </div>
        </div>
    </footer>

    <script>
        // Login functionality
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // Mock authentication
            if ((username === 'dr.priya' && password === 'secure123') || 
                (username === 'admin' && password === 'admin2025')) {
                
                // Hide login modal and show dashboard
                document.getElementById('loginModal').classList.add('hidden');
                document.getElementById('dashboardContent').classList.remove('hidden');
                
                // Update welcome name based on login
                const welcomeName = username === 'admin' ? 'Admin' : 'Dr. Priya';
                const doctorName = username === 'admin' ? 'System Administrator' : 'Dr. Priya Sharma';
                
                document.getElementById('welcomeName').textContent = welcomeName;
                document.getElementById('doctorName').textContent = doctorName;
                
                // Set current date
                const today = new Date();
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('currentDate').textContent = today.toLocaleDateString('en-US', options);
                
            } else {
                alert('Invalid credentials. Please use the demo credentials provided.');
            }
        }

        // Logout functionality
        function logout() {
            document.getElementById('loginModal').classList.remove('hidden');
            document.getElementById('dashboardContent').classList.add('hidden');
            document.getElementById('loginForm').reset();
        }

        // Toggle user menu
        function toggleUserMenu() {
            const userMenu = document.getElementById('userMenu');
            userMenu.classList.toggle('hidden');
        }

        // Close user menu when clicking outside
        document.addEventListener('click', function(event) {
            const userMenu = document.getElementById('userMenu');
            const userButton = event.target.closest('button');
            
            if (!userButton || !userButton.onclick || userButton.onclick.toString().indexOf('toggleUserMenu') === -1) {
                userMenu.classList.add('hidden');
            }
        });

        // Dashboard functions
        function refreshSchedule() {
            alert('Schedule refreshed successfully!');
        }

        function addAppointment() {
            alert('Redirecting to appointment booking system...');
            window.location.href = 'appointment_booking_system.html';
        }

        function viewPatient(patientId) {
            alert(`Opening patient record for: ${patientId}`);
        }

        function startConsultation(patientId) {
            alert(`Starting consultation for: ${patientId}`);
        }

        function viewAllAppointments() {
            alert('Opening full appointment schedule...');
        }

        function createPrescription() {
            alert('Opening prescription creation interface...');
        }

        function viewReports() {
            alert('Opening practice reports dashboard...');
        }

        function manageInventory() {
            alert('Opening inventory management system...');
        }

        function showEmergencySlot() {
            alert('Creating emergency appointment slot...');
        }

        function generateReport() {
            alert('Generating practice analytics report...');
        }

        function viewAllPatients() {
            alert('Opening complete patient database...');
        }

        function addNewPatient() {
            alert('Opening new patient registration form...');
        }

        function viewPatientDetails(patientId) {
            alert(`Opening detailed view for patient: ${patientId}`);
        }

        function editPatient(patientId) {
            alert(`Opening edit form for patient: ${patientId}`);
        }

        function createPrescriptionFor(patientId) {
            alert(`Creating prescription for patient: ${patientId}`);
        }

        // Initialize dashboard on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = today.toLocaleDateString('en-US', options);
        });
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>